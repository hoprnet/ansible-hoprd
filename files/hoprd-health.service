[Unit]
Description=Hoprd node healthcheck
After=docker.service
Requires=docker.service

[Service]
User=root
Group=root
Type=oneshot
ExecStart=/bin/bash -c '\
  status=$(docker inspect --format="{{.State.Health.Status}}" hoprd 2>/dev/null); \
  if [ "$status" == "unhealthy" ]; then \
    echo "[$(date)] hoprd unhealthy: $status â€” restarting container"; \
    systemctl restart hoprd.service; \
  else \
    echo "[$(date)] hoprd healthy"; \
  fi'

[Install]
WantedBy=multi-user.target